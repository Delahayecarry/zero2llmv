# RTX 4090 ä¼˜åŒ–é…ç½®
# æ ¹æ®RTX 4090ç¡¬ä»¶ç‰¹æ€§ä¼˜åŒ–çš„VLMè®­ç»ƒé…ç½®

model:
  model_type: "vlm"
  # æ¨¡å‹ç»“æ„é…ç½®
  hidden_size: 512
  num_hidden_layers: 8
  max_seq_len: 1024        # ğŸ”§ å¢åŠ åˆ°1024ä»¥å……åˆ†åˆ©ç”¨æ˜¾å­˜
  use_moe: false
  # è§†è§‰æ¨¡å‹è·¯å¾„
  vision_model_path: "../model/vision_model/clip-vit-base-patch16"
  # LLMæƒé‡è·¯å¾„ï¼ˆç”¨äºåˆå§‹åŒ–ï¼‰
  llm_weights_dir: "../out"

data:
  # æ•°æ®è·¯å¾„
  data_path: "../dataset/pretrain_data.jsonl"
  images_path: "../dataset/pretrain_images"
  # æ•°æ®åŠ è½½é…ç½® - RTX 4090ä¼˜åŒ–
  batch_size: 32           # ğŸ”§ ä»16å¢åŠ åˆ°32ï¼Œå……åˆ†åˆ©ç”¨24GBæ˜¾å­˜
  num_workers: 12          # ğŸ”§ å¢åŠ åˆ°12ï¼ŒåŒ¹é…CPUæ ¸å¿ƒæ•°
  max_seq_length: 1024     # ğŸ”§ ä¸æ¨¡å‹é…ç½®ä¿æŒä¸€è‡´

training:
  # è®­ç»ƒè¶…å‚æ•°
  num_epochs: 4
  learning_rate: 2e-4      # ğŸ”§ é™ä½å­¦ä¹ ç‡é€‚åº”æ›´å¤§batch size
  weight_decay: 0.01
  
  # è®­ç»ƒæ§åˆ¶ - ä¼˜åŒ–GPUåˆ©ç”¨ç‡
  accumulation_steps: 2    # ğŸ”§ æœ‰æ•ˆbatch size = 32 * 2 = 64
  grad_clip: 1.0
  warmup_iters: 500        # ğŸ”§ æ·»åŠ warmupç¨³å®šè®­ç»ƒ
  
  # æ··åˆç²¾åº¦è®¾ç½® - RTX 4090æœ€ä¼˜
  dtype: "bfloat16"
  use_amp: true
  
  # ä¼˜åŒ–å™¨è®¾ç½®
  optimizer: "adamw"
  beta1: 0.9
  beta2: 0.95             # ğŸ”§ æ›´é€‚åˆå¤§æ¨¡å‹çš„beta2å€¼
  eps: 1e-8
  
  # è®¾å¤‡é…ç½®
  device: "cuda:0"

checkpoints:
  # è¾“å‡ºå’Œä¿å­˜
  output_dir: "../out"
  save_interval: 200       # ğŸ”§ å‡å°‘ä¿å­˜é¢‘ç‡ï¼Œæé«˜è®­ç»ƒæ•ˆç‡
  log_interval: 50         # ğŸ”§ å¢åŠ æ—¥å¿—é¢‘ç‡ï¼Œæ›´å¥½ç›‘æ§
  
  # åˆ†å¸ƒå¼è®­ç»ƒ
  ddp: false
  local_rank: -1

# æ€§èƒ½ä¼˜åŒ–é…ç½®
performance:
  # CUDAä¼˜åŒ–
  cuda_compile: true       # ğŸ”§ å¯ç”¨CUDAç¼–è¯‘ä¼˜åŒ–
  flash_attention: true    # ğŸ”§ å¯ç”¨FlashAttentionèŠ‚çœæ˜¾å­˜
  gradient_checkpointing: false  # ğŸ”§ 24GBæ˜¾å­˜è¶³å¤Ÿï¼Œä¸éœ€è¦æ¢¯åº¦æ£€æŸ¥ç‚¹
  
  # å†…å­˜ä¼˜åŒ–
  pin_memory: true
  persistent_workers: true
  prefetch_factor: 2

swanlab:
  # zerollm-v é¡¹ç›®é…ç½®
  project: "zerollm-v"
  experiment_name: "vlm-rtx4090-optimized"
  description: "RTX 4090ä¼˜åŒ–çš„zerollm-v VLMé¢„è®­ç»ƒå®éªŒ"
  
  # SwanLabæ—¥å¿—é…ç½®
  logdir: "./swanlab_logs"
  
  # è¿è¡Œé…ç½®
  tags: ["vlm", "pretrain", "rtx4090", "optimized"]
  
# æ¨¡å‹ç‰¹å®šé…ç½®
vlm_specific:
  # å†»ç»“ç­–ç•¥ï¼šåªè®­ç»ƒvision_projå±‚
  freeze_llm: true
  freeze_vision_encoder: true
  trainable_modules: ["vision_proj"]
  
  # å›¾åƒå¤„ç†
  image_special_token: "<image>"
  
# ç³»ç»Ÿé…ç½®
system:
  # éšæœºç§å­
  random_seed: 1337
  
  # è­¦å‘Šè¿‡æ»¤
  ignore_warnings: true
  
  # æ—¥å¿—çº§åˆ«
  log_level: "INFO"
  
